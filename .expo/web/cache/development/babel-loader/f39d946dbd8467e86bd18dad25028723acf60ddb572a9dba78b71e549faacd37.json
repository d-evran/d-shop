{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport { createUserWithEmailAndPassword } from \"firebase/auth\";\nimport { auth, db } from \"../../services/firebase\";\nimport { addDoc, collection, getDocs, query, serverTimestamp } from \"firebase/firestore\";\nvar initialState = {\n  name: \"Username\",\n  email: \"E-mail@email.com\",\n  password: \"123456\",\n  user: {}\n};\nexport var createAndAddUserToDatabaseAsync = createAsyncThunk(\"login/createAndAddUserToDatabaseAsync\", function () {\n  var _ref2 = _asyncToGenerator(function* (_ref) {\n    var name = _ref.name,\n      email = _ref.email,\n      password = _ref.password;\n    console.log(\"create user\", name, email, password);\n    yield createUserWithEmailAndPassword(auth, email, password).then(function (userCredential) {\n      var user = userCredential.user;\n      addUserToDatabase(user, name, email, password);\n    });\n    var userRef = collection(db, \"users\");\n    var q = query(userRef);\n    return getDocs(q).then(function (querySnapshot) {\n      var data = [];\n      querySnapshot.forEach(function (doc) {\n        data.push({\n          id: doc.id,\n          name: doc.data().name,\n          money: doc.data().money,\n          email: doc.data().email\n        });\n      });\n      return data;\n    });\n  });\n  return function (_x) {\n    return _ref2.apply(this, arguments);\n  };\n}());\nvar addUserToDatabase = function () {\n  var _ref3 = _asyncToGenerator(function* (user, name, email, password) {\n    yield addDoc(collection(db, \"users\"), {\n      email: email,\n      password: password,\n      name: name,\n      uid: user.uid,\n      money: 201.5,\n      createdAt: serverTimestamp()\n    }).then(function () {\n      console.log(\"User added to firestore\");\n    });\n  });\n  return function addUserToDatabase(_x2, _x3, _x4, _x5) {\n    return _ref3.apply(this, arguments);\n  };\n}();\nvar loginSlice = createSlice({\n  name: \"login\",\n  initialState: initialState,\n  reducers: {\n    handleChangeName: function handleChangeName(state, action) {\n      state.name = action.payload;\n    },\n    handleChangeEmail: function handleChangeEmail(state, action) {\n      state.email = action.payload;\n    },\n    handleChangePassword: function handleChangePassword(state, action) {\n      state.password = action.payload;\n    }\n  },\n  extraReducers: function extraReducers(builder) {\n    builder.addCase(createAndAddUserToDatabaseAsync.fulfilled, function (state, action) {\n      var userArray = action.payload;\n      console.log(\"userArray\", JSON.stringify(userArray, null, 2));\n      var user = userArray.find(function (user) {\n        return user.name === state.name && user.email === state.email;\n      });\n      state.user = user;\n    });\n  }\n});\nvar _loginSlice$actions = loginSlice.actions,\n  handleChangeName = _loginSlice$actions.handleChangeName,\n  handleChangeEmail = _loginSlice$actions.handleChangeEmail,\n  handleChangePassword = _loginSlice$actions.handleChangePassword;\nexport { handleChangeName, handleChangeEmail, handleChangePassword };\nexport var selectName = function selectName(state) {\n  return state.login.name;\n};\nexport var selectEmail = function selectEmail(state) {\n  return state.login.email;\n};\nexport var selectPassword = function selectPassword(state) {\n  return state.login.password;\n};\nexport var selectUser = function selectUser(state) {\n  return state.login.user;\n};\nexport default loginSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","createUserWithEmailAndPassword","auth","db","addDoc","collection","getDocs","query","serverTimestamp","initialState","name","email","password","user","createAndAddUserToDatabaseAsync","_ref2","_asyncToGenerator","_ref","console","log","then","userCredential","addUserToDatabase","userRef","q","querySnapshot","data","forEach","doc","push","id","money","_x","apply","arguments","_ref3","uid","createdAt","_x2","_x3","_x4","_x5","loginSlice","reducers","handleChangeName","state","action","payload","handleChangeEmail","handleChangePassword","extraReducers","builder","addCase","fulfilled","userArray","JSON","stringify","find","_loginSlice$actions","actions","selectName","login","selectEmail","selectPassword","selectUser","reducer"],"sources":["C:/Users/Didem/source/repos/03-MOBIL/Görevler/Görev 18/18-didemevran/src/screens/Login/loginSlice.ts"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\r\nimport { createUserWithEmailAndPassword } from \"firebase/auth\";\r\nimport { auth, db } from \"../../services/firebase\";\r\nimport {\r\n  addDoc,\r\n  collection,\r\n  getDocs,\r\n  query,\r\n  serverTimestamp,\r\n} from \"firebase/firestore\";\r\n\r\nconst initialState = {\r\n  name: \"Username\",\r\n  email: \"E-mail@email.com\",\r\n  password: \"123456\",\r\n  user: {},\r\n};\r\n\r\nexport const createAndAddUserToDatabaseAsync = createAsyncThunk(\r\n  \"login/createAndAddUserToDatabaseAsync\",\r\n  // @ts-ignore\r\n  async ({name,email,password}: {name: string;email: string;password: string}) => {\r\n    console.log(\"create user\", name, email, password);\r\n    await createUserWithEmailAndPassword(auth, email, password).then(\r\n      (userCredential) => {\r\n        // Signed in\r\n        const user = userCredential.user;\r\n        addUserToDatabase(user, name, email, password);\r\n      }\r\n    );\r\n    const userRef = collection(db, \"users\");\r\n    const q = query(userRef);\r\n    return getDocs(q)\r\n      .then((querySnapshot) => {\r\n        const data = [];\r\n        querySnapshot.forEach((doc) => {\r\n          data.push({\r\n            id: doc.id,\r\n            name: doc.data().name,\r\n            money: doc.data().money,\r\n            email: doc.data().email,\r\n          });\r\n        });\r\n        return data;\r\n      })\r\n  }\r\n);\r\n\r\nconst addUserToDatabase = async (user, name, email, password) => {\r\n   await addDoc(collection(db, \"users\"), {\r\n    email: email,\r\n    password: password,\r\n    name: name,\r\n    uid: user.uid,\r\n    money: 201.5,\r\n    createdAt: serverTimestamp(),\r\n  }).then(() => {\r\n    console.log(\"User added to firestore\");\r\n  });\r\n};\r\n\r\nconst loginSlice = createSlice({\r\n  name: \"login\",\r\n  initialState,\r\n  reducers: {\r\n    handleChangeName: (state, action) => {\r\n      state.name = action.payload;\r\n    },\r\n    handleChangeEmail: (state, action) => {\r\n      state.email = action.payload;\r\n    },\r\n    handleChangePassword: (state, action) => {\r\n      state.password = action.payload;\r\n    },\r\n  },\r\n  extraReducers(builder) {\r\n    builder.addCase(createAndAddUserToDatabaseAsync.fulfilled, (state, action) => {\r\n      const userArray = action.payload;\r\n      console.log(\"userArray\",JSON.stringify(userArray, null, 2))\r\n      const user = userArray.find(user => user.name === state.name && user.email === state.email)\r\n      state.user = user;\r\n    });\r\n  },\r\n});\r\nexport const { handleChangeName, handleChangeEmail, handleChangePassword } =\r\n  loginSlice.actions;\r\n\r\nexport const selectName = (state) => state.login.name;\r\nexport const selectEmail = (state) => state.login.email;\r\nexport const selectPassword = (state) => state.login.password;\r\nexport const selectUser = (state) => state.login.user;\r\n\r\nexport default loginSlice.reducer;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}